{
  "hash": "20d68a4e2b9c6572107a2af8993d3d26",
  "result": {
    "markdown": "---\ntitle: \"Graphic Design with ggplot2\"\nsubtitle: \"<span style='font-size:1.75em;line-height:1.1;'>Working with Layouts and Composition</span>\"\nauthor: \"<b style='color:#28a87d;'>Cédric Scherer</b> **//** rstudio::conf **//** July 2022\"\nformat:\n  revealjs:\n    theme: css/style.scss\n    footer: '**[Cédric Scherer](https::/cedricscherer.com) //** rstudio::conf **//** July 2022'\n    #'rstudio::conf(workshop = \"Graphic Design with ggplot2\", instructor = \"Cédric Scherer\")'\n    transition: fade\n    progress: true\n    multiplex: false\n    preview-links: true\n    scrollable: false\n    hide-inactive-cursor: true\n    highlight-style: printing\n    chalkboard:\n      theme: whiteboard\n      boardmarker-width: 4\n      buttons: true\n    pause: true\n    mainfont: Cabinet Grotesk\neditor: source\nknitr:\n  opts_chunk:\n    dev: \"ragg_png\"\n    retina: 1\n    dpi: 300\nexecute:\n  freeze: auto\n  echo: true\n  fig-width: 5\n  fig-height: 6\n---\n\n\n## Setup\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n\nbikes <- readr::read_csv(\n  here::here(\"data\", \"london-bikes-custom.csv\"),\n  col_types = \"Dcfffilllddddc\"\n)\n\nbikes$season <- forcats::fct_inorder(bikes$season)\n\ntheme_set(theme_light(base_size = 14, base_family = \"Roboto Condensed\"))\n\ntheme_update(\n  panel.grid.minor = element_blank(),\n  plot.title = element_text(face = \"bold\"),\n  plot.title.position = \"plot\"\n)\n```\n:::\n\n\n# Legend Placement<br>and Styling\n\n## Discrete Legend\n\n\n::: {.cell output-location='column'}\n\n```{.r .cell-code  code-line-numbers=\"6|9\"}\npal <- c(\"#3c89d9\", \"#1ec99b\", \"#F7B01B\", \"#a26e7c\")\n\nggplot(\n    bikes,\n    aes(x = temp_feel, y = count,\n        color = season)\n  ) +\n  geom_point() +\n  scale_color_manual(values = pal)\n```\n\n::: {.cell-output-display}\n![](07_layout_files/figure-revealjs/legend-discrete-default-1.png){width=1500}\n:::\n:::\n\n\n## Continuous Legend\n\n\n::: {.cell output-location='column'}\n\n```{.r .cell-code  code-line-numbers=\"4|7\"}\nggplot(\n    bikes,\n    aes(x = temp_feel, y = count,\n        color = humidity)\n  ) +\n  geom_point() +\n  scale_color_viridis_c()\n```\n\n::: {.cell-output-display}\n![](07_layout_files/figure-revealjs/legend-continuous-default-1.png){width=1500}\n:::\n:::\n\n\n## Legend Position\n\n\n::: {.cell output-location='column'}\n\n```{.r .cell-code  code-line-numbers=\"8,9,10\"}\nggplot(\n    bikes,\n    aes(x = temp_feel, y = count,\n        color = humidity)\n  ) +\n  geom_point() +\n  scale_color_viridis_c() +\n  theme(\n    legend.position = \"bottom\"\n  )\n```\n\n::: {.cell-output-display}\n![](07_layout_files/figure-revealjs/legend-position-bottom-1.png){width=1500}\n:::\n:::\n\n\n## Legend Justification\n\n\n::: {.cell output-location='column'}\n\n```{.r .cell-code  code-line-numbers=\"10\"}\nggplot(\n    bikes,\n    aes(x = temp_feel, y = count,\n        color = humidity)\n  ) +\n  geom_point() +\n  scale_color_viridis_c() +\n  theme(\n    legend.position = \"bottom\",\n    legend.justification = \"left\"\n  )\n```\n\n::: {.cell-output-display}\n![](07_layout_files/figure-revealjs/legend-position-bottom-left-1.png){width=1500}\n:::\n:::\n\n\n## Legend Position\n\n\n::: {.cell output-location='column'}\n\n```{.r .cell-code  code-line-numbers=\"9\"}\nggplot(\n    bikes,\n    aes(x = temp_feel, y = count,\n        color = humidity)\n  ) +\n  geom_point() +\n  scale_color_viridis_c() +\n  theme(\n    legend.position = c(.25, .85)\n  )\n```\n\n::: {.cell-output-display}\n![](07_layout_files/figure-revealjs/legend-position-inside-1.png){width=1500}\n:::\n:::\n\n\n## Legend Direction\n\n\n::: {.cell output-location='column'}\n\n```{.r .cell-code  code-line-numbers=\"10\"}\nggplot(\n    bikes,\n    aes(x = temp_feel, y = count,\n        color = humidity)\n  ) +\n  geom_point() +\n  scale_color_viridis_c() +\n  theme(\n    legend.position = c(.25, .85),\n    legend.direction = \"horizontal\"\n  )\n```\n\n::: {.cell-output-display}\n![](07_layout_files/figure-revealjs/legend-position-inside-horizontal-1.png){width=1500}\n:::\n:::\n\n\n## Legend Types\n\n\n::: {.cell output-location='column'}\n\n```{.r .cell-code  code-line-numbers=\"8\"}\nggplot(\n    bikes,\n    aes(x = temp_feel, y = count,\n        color = humidity)\n  ) +\n  geom_point() +\n  scale_color_viridis_c(\n    guide = \"colorbar\"\n  ) +\n  theme(\n    legend.position = c(.25, .85),\n    legend.direction = \"horizontal\"\n  )\n```\n\n::: {.cell-output-display}\n![](07_layout_files/figure-revealjs/legend-guide-quotes-1.png){width=1500}\n:::\n:::\n\n\n## Legend Types\n\n\n::: {.cell output-location='column'}\n\n```{.r .cell-code  code-line-numbers=\"8\"}\nggplot(\n    bikes,\n    aes(x = temp_feel, y = count,\n        color = humidity)\n  ) +\n  geom_point() +\n  scale_color_viridis_c(\n    guide = \"colorsteps\"\n  ) +\n  theme(\n    legend.position = c(.25, .85),\n    legend.direction = \"horizontal\"\n  )\n```\n\n::: {.cell-output-display}\n![](07_layout_files/figure-revealjs/legend-guide-quotes-colorsteps-1.png){width=1500}\n:::\n:::\n\n\n## Legend Types\n\n\n::: {.cell output-location='column'}\n\n```{.r .cell-code  code-line-numbers=\"7\"}\nggplot(\n    bikes,\n    aes(x = temp_feel, y = count,\n        color = humidity)\n  ) +\n  geom_point() +\n  scale_color_viridis_b(\n    guide = \"colorsteps\"\n  ) +\n  theme(\n    legend.position = c(.25, .85),\n    legend.direction = \"horizontal\"\n  )\n```\n\n::: {.cell-output-display}\n![](07_layout_files/figure-revealjs/legend-guide-binned-scale-1.png){width=1500}\n:::\n:::\n\n\n## Legend Types\n\n\n::: {.cell output-location='column'}\n\n```{.r .cell-code  code-line-numbers=\"8\"}\nggplot(\n    bikes,\n    aes(x = temp_feel, y = count,\n        color = humidity)\n  ) +\n  geom_point() +\n  scale_color_viridis_b(\n    guide = guide_colorsteps()\n  ) +\n  theme(\n    legend.position = c(.25, .85),\n    legend.direction = \"horizontal\"\n  )\n```\n\n::: {.cell-output-display}\n![](07_layout_files/figure-revealjs/legend-guide-function-colorsteps-1.png){width=1500}\n:::\n:::\n\n\n## Legend Styling\n\n\n::: {.cell output-location='column'}\n\n```{.r .cell-code  code-line-numbers=\"9,10\"}\nggplot(\n    bikes,\n    aes(x = temp_feel, y = count,\n        color = humidity)\n  ) +\n  geom_point() +\n  scale_color_viridis_b(\n    guide = guide_colorsteps(\n      title.position = \"top\",\n      title.hjust = .5\n    )\n  ) +\n  theme(\n    legend.position = c(.25, .85),\n    legend.direction = \"horizontal\"\n  )\n```\n\n::: {.cell-output-display}\n![](07_layout_files/figure-revealjs/legend-guide-function-adjust-title-1.png){width=1500}\n:::\n:::\n\n\n## Legend Styling\n\n\n::: {.cell output-location='column'}\n\n```{.r .cell-code  code-line-numbers=\"11,12,13,14\"}\nggplot(\n    bikes,\n    aes(x = temp_feel, y = count,\n        color = humidity)\n  ) +\n  geom_point() +\n  scale_color_viridis_b(\n    guide = guide_colorsteps(\n      title.position = \"top\",\n      title.hjust = .5,\n      show.limits = TRUE,\n      frame.colour = \"black\",\n      frame.linewidth = 3,\n      barwidth = unit(8, \"lines\")\n    )\n  ) +\n  theme(\n    legend.position = c(.25, .85),\n    legend.direction = \"horizontal\"\n  )\n```\n\n::: {.cell-output-display}\n![](07_layout_files/figure-revealjs/legend-guide-function-customize-1.png){width=1500}\n:::\n:::\n\n\n## Legend Styling\n\n\n::: {.cell output-location='column'}\n\n```{.r .cell-code  code-line-numbers=\"19|7,10|8,9|13,14,15\"}\nggplot(\n    bikes,\n    aes(x = temp_feel, y = count,\n        color = humidity)\n  ) +\n  geom_point() +\n  scale_color_viridis_c(\n    breaks = 3:10*10,\n    limits = c(30, 100),\n    guide = guide_colorbar(\n      title.position = \"top\",\n      title.hjust = .5,\n      ticks.linewidth = 3,\n      barwidth = unit(20, \"lines\"),\n      barheight = unit(.6, \"lines\")\n    )\n  ) +\n  theme(\n    legend.position = \"top\"\n  )\n```\n\n::: {.cell-output-display}\n![](07_layout_files/figure-revealjs/legend-guide-function-customize-ticks-1.png){width=1500}\n:::\n:::\n\n\n## Legend Styling\n\n\n::: {.cell output-location='column'}\n\n```{.r .cell-code  code-line-numbers=\"14,15\"}\nggplot(\n    bikes,\n    aes(x = temp_feel, y = count,\n        color = humidity)\n  ) +\n  geom_point() +\n  scale_color_viridis_c(\n    breaks = 3:10*10,\n    limits = c(30, 100),\n    guide = guide_colorbar(\n      title.position = \"top\",\n      title.hjust = .5,\n      ticks.linewidth = 3,\n      draw.ulim = FALSE,\n      draw.llim = FALSE,\n      barwidth = unit(20, \"lines\"),\n      barheight = unit(.6, \"lines\")\n    )\n  ) +\n  theme(\n    legend.position = \"top\"\n  )\n```\n\n::: {.cell-output-display}\n![](07_layout_files/figure-revealjs/legend-guide-function-customize-ticks-limits-1.png){width=1500}\n:::\n:::\n\n\n## Legend Styling\n\n\n::: {.cell output-location='column'}\n\n```{.r .cell-code  code-line-numbers=\"13\"}\nggplot(\n    bikes,\n    aes(x = temp_feel, y = count,\n        color = humidity)\n  ) +\n  geom_point() +\n  scale_color_viridis_c(\n    breaks = 4:10*10,\n    limits = c(30, 100),\n    guide = guide_colorbar(\n      title.position = \"top\",\n      title.hjust = .5,\n      ticks = FALSE,\n      barwidth = unit(20, \"lines\"),\n      barheight = unit(.6, \"lines\")\n    )\n  ) +\n  theme(\n    legend.position = \"top\"\n  )\n```\n\n::: {.cell-output-display}\n![](07_layout_files/figure-revealjs/legend-guide-function-customize-ticks-no-1.png){width=1500}\n:::\n:::\n\n\n## Key Glyphs\n\n\n::: {.cell output-location='column'}\n\n```{.r .cell-code  code-line-numbers=\"1,2,3,4,5,6|7,8,9,10,11|12,13,14,15|16,17,18\"}\nggplot(\n    bikes,\n    aes(x = lubridate::week(date),\n        y = count,\n        color = day_night)\n  ) +\n  stat_summary(\n    geom = \"line\",\n    fun = sum,\n    size = 1\n  ) +\n  scale_color_manual(\n    values = c(\"#28A87D\", \"#663399\"),\n    name = NULL\n  ) +\n  theme(\n    legend.text = element_text(size = 16)\n  )\n```\n\n::: {.cell-output-display}\n![](07_layout_files/figure-revealjs/legend-glyph-prep-1.png){width=1500}\n:::\n:::\n\n\n## Key Glyphs\n\n\n::: {.cell output-location='column'}\n\n```{.r .cell-code  code-line-numbers=\"10\"}\nggplot(\n    bikes,\n    aes(x = lubridate::week(date),\n        y = count,\n        color = day_night)\n  ) +\n  stat_summary(\n    geom = \"line\",\n    fun = sum,\n    key_glyph = \"timeseries\",\n    size = 1\n  ) +\n  scale_color_manual(\n    values = c(\"#28A87D\", \"#663399\"),\n    name = NULL\n  ) +\n  theme(\n    legend.text = element_text(size = 16)\n  )\n```\n\n::: {.cell-output-display}\n![](07_layout_files/figure-revealjs/legend-glyph-timeseries-1.png){width=1500}\n:::\n:::\n\n\n## Key Glyphs\n\n\n::: {.cell output-location='column'}\n\n```{.r .cell-code  code-line-numbers=\"10\"}\nggplot(\n    bikes,\n    aes(x = lubridate::week(date),\n        y = count,\n        color = day_night)\n  ) +\n  stat_summary(\n    geom = \"line\",\n    fun = sum,\n    key_glyph = \"vline\",\n    size = 1\n  ) +\n  scale_color_manual(\n    values = c(\"#28A87D\", \"#663399\"),\n    name = NULL\n  ) +\n  theme(\n    legend.text = element_text(size = 16)\n  )\n```\n\n::: {.cell-output-display}\n![](07_layout_files/figure-revealjs/legend-glyph-vline-1.png){width=1500}\n:::\n:::\n\n\n# Composing ggplot's\n\n------------------------------------------------------------------------\n\n![Illustration by Allison Horst](img/layout/ah_patchwork.jpg){fig-align=\"center\" fig-alt=\"Allison Horsts monster illustration of the patchwork extension package.\"}\n\n::: footer\n:::\n\n------------------------------------------------------------------------\n\n::: panel-tabset\n### Graphic\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](07_layout_files/figure-revealjs/patchwork-p1-1.png){width=3000}\n:::\n:::\n\n\n### Code\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntheme_set(theme_minimal(base_size = 18, base_family = \"Pally\"))\ntheme_update(\n  text = element_text(family = \"Pally\"),\n  panel.grid = element_blank(),\n  axis.text = element_text(color = \"grey50\", size = 12),\n  axis.title = element_text(color = \"grey40\", face = \"bold\"),\n  axis.title.x = element_text(margin = margin(t = 12)),\n  axis.title.y = element_text(margin = margin(r = 12)),\n  axis.line = element_line(color = \"grey80\", size = .4),\n  legend.text = element_text(color = \"grey50\", size = 12),\n  plot.tag = element_text(size = 40, margin = margin(b = 15)),\n  plot.background = element_rect(fill = \"white\", color = \"white\")\n)\n\nbikes_sorted <-\n  bikes %>%\n  filter(!is.na(weather_type)) %>%\n  group_by(weather_type) %>%\n  mutate(sum = sum(count)) %>%\n  ungroup() %>%\n  mutate(\n    weather_type = forcats::fct_reorder(\n      str_to_title(str_wrap(weather_type, 5)), sum\n    )\n  )\n\np1 <- ggplot(\n    bikes_sorted,\n    aes(x = weather_type, y = count, color = weather_type)\n  ) +\n  geom_hline(yintercept = 0, color = \"grey80\", size = .4) +\n  stat_summary(\n    geom = \"point\", fun = \"sum\", size = 12\n  ) +\n  stat_summary(\n    geom = \"linerange\", ymin = 0, fun.max = function(y) sum(y),\n    size = 2, show.legend = FALSE\n  ) +\n  coord_flip(ylim = c(0, NA), clip = \"off\") +\n  scale_y_continuous(\n    expand = c(0, 0), limits = c(0, 8500000),\n    labels = scales::comma_format(scale = .0001, suffix = \"K\")\n  ) +\n  scale_color_viridis_d(\n    option = \"magma\", direction = -1, begin = .1, end = .9, name = NULL,\n    guide = guide_legend(override.aes = list(size = 7))\n  ) +\n  labs(\n    x = NULL, y = \"Sum of reported bike shares\", tag = \"P1\",\n  ) +\n  theme(\n    axis.line.y = element_blank(),\n    axis.text.y = element_text(family = \"Pally\", color = \"grey50\", face = \"bold\",\n                               margin = margin(r = 15), lineheight = .9)\n  )\n\np1\n```\n:::\n\n:::\n\n------------------------------------------------------------------------\n\n::: panel-tabset\n### Graphic\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](07_layout_files/figure-revealjs/patchwork-p2-1.png){width=3000}\n:::\n:::\n\n\n### Code\n\n\n::: {.cell}\n\n```{.r .cell-code}\np2 <- bikes_sorted %>%\n  filter(season == \"winter\", is_weekend == TRUE, day_night == \"night\") %>%\n  group_by(weather_type, .drop = FALSE) %>%\n  mutate(id = row_number()) %>%\n  ggplot(\n      aes(x = weather_type, y = id, color = weather_type)\n    ) +\n    geom_point(size = 4.5) +\n    scale_color_viridis_d(\n      option = \"magma\", direction = -1, begin = .1, end = .9, name = NULL,\n      guide = guide_legend(override.aes = list(size = 7))\n    ) +\n    labs(\n      x = NULL, y = \"Reported bike shares on\\nweekend winter nights\", tag = \"P2\",\n    ) +\n    coord_cartesian(ylim = c(.5, NA), clip = \"off\")\n\np2\n```\n:::\n\n:::\n\n------------------------------------------------------------------------\n\n::: panel-tabset\n### Graphic\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](07_layout_files/figure-revealjs/patchwork-p3-1.png){width=3000}\n:::\n:::\n\n\n### Code\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_colors <- c(\"#cc0000\", \"#000080\")\n\np3 <- bikes %>%\n  group_by(week = lubridate::week(date), day_night, year) %>%\n  summarize(count = sum(count)) %>%\n  group_by(week, day_night) %>%\n  mutate(avg = mean(count)) %>%\n  ggplot(aes(x = week, y = count, group = interaction(day_night, year))) +\n    geom_line(color = \"grey65\", size = 1) +\n    geom_line(aes(y = avg, color = day_night), stat = \"unique\", size = 1.7) +\n    annotate(\n      geom = \"text\", label = c(\"Day\", \"Night\"), color = my_colors,\n      x = c(5, 18), y = c(125000, 29000), size = 8, fontface = \"bold\", family = \"Pally\"\n    ) +\n    scale_x_continuous(breaks = c(1, 1:10*5)) +\n    scale_y_continuous(labels = scales::comma_format()) +\n    scale_color_manual(values = my_colors, guide = \"none\") +\n    labs(\n      x = \"Week of the Year\", y = \"Reported bike shares\\n(cumulative # per week)\", tag = \"P3\",\n    )\n\np3\n```\n:::\n\n:::\n\n## {patchwork}\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-line-numbers=\"3|2,3\"}\n# install.packages(\"patchwork\")\nlibrary(patchwork)\n(p1 + p2) / p3\n```\n\n::: {.cell-output-display}\n![](07_layout_files/figure-revealjs/patchwork-composition-1.png){fig-align='center' width=4500}\n:::\n:::\n\n\n## \"Collect Guides\"\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n(p1 + p2) / p3 + plot_layout(guides = \"collect\")\n```\n\n::: {.cell-output-display}\n![](07_layout_files/figure-revealjs/patchwork-composition-guides-1.png){fig-align='center' width=4500}\n:::\n:::\n\n\n## Apply Theming\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n((p1 + p2) / p3 & theme(legend.justification = \"top\")) + plot_layout(guides = \"collect\")\n```\n\n::: {.cell-output-display}\n![](07_layout_files/figure-revealjs/patchwork-composition-guides-just-1.png){fig-align='center' width=4500}\n:::\n:::\n\n\n## Apply Theming\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n(p1 + p2) / p3 & theme(legend.position = \"none\", plot.background = element_rect(color = \"black\", size = 3))\n```\n\n::: {.cell-output-display}\n![](07_layout_files/figure-revealjs/patchwork-composition-legend-off-1.png){fig-align='center' width=4500}\n:::\n:::\n\n\n## Adjust Widths and Heights\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-line-numbers=\"2\"}\n((p1 + p2) / p3 & theme(legend.position = \"none\")) +\n  plot_layout(heights = c(.2, .15), widths = c(1.4, 1))\n```\n\n::: {.cell-output-display}\n![](07_layout_files/figure-revealjs/patchwork-composition-heights-widths-1.png){fig-align='center' width=4500}\n:::\n:::\n\n\n## Use A Custom Layout\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-line-numbers=\"1,2,3,4|5\"}\npicasso <- \"\nAAAAAA#BBBB\nCCCCCCCCCCC\nCCCCCCCCCCC\"\n(p1 + p2 + p3 & theme(legend.position = \"none\")) + plot_layout(design = picasso)\n```\n\n::: {.cell-output-display}\n![](07_layout_files/figure-revealjs/patchwork-composition-design-1.png){fig-align='center' width=4500}\n:::\n:::\n\n\n## Add Labels\n\n\n::: {.cell}\n\n```{.r .cell-code}\npl1 <- p1 + labs(tag = NULL, title = \"Plot One\") + theme(legend.position = \"none\")\npl2 <- p2 + labs(tag = NULL, title = \"Plot Two\") + theme(legend.position = \"none\")\npl3 <- p3 + labs(tag = NULL, title = \"Plot Three\") + theme(legend.position = \"none\")\n```\n:::\n\n\n## Add Labels\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-line-numbers=\"2\"}\n(pl1 + pl2) / pl3 +\n  plot_annotation(tag_levels = \"1\", tag_prefix = \"P\", title = \"An overarching title for all 3 plots, placed on the very top while all other titles are sitting below the tags.\")\n```\n\n::: {.cell-output-display}\n![](07_layout_files/figure-revealjs/patchwork-composition-labs-1.png){fig-align='center' width=4500}\n:::\n:::\n\n\n## Add Text\n\n::: panel-tabset\n### Graphic\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](07_layout_files/figure-revealjs/patchwork-composition-textbox-prep-1.png){fig-align='center' width=2700}\n:::\n:::\n\n\n### Code\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntext <- tibble(\n  x = 0, y = 0, label = \"Lorem ipsum dolor sit amet, **consectetur adipiscing elit**, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation <b style='color:#000080;'>ullamco laboris nisi</b> ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat <b style='color:#cc0000;'>cupidatat non proident</b>, sunt in culpa qui officia deserunt mollit anim id est laborum.\"\n)\n\npt <- ggplot(text, aes(x = x, y = y)) +\n  ggtext::geom_textbox(\n    aes(label = label),\n    box.color = NA, width = unit(23, \"lines\"),\n    family = \"Pally\", color = \"grey40\", size = 6.5, lineheight = 1.4\n  ) +\n  coord_cartesian(expand = FALSE, clip = \"off\") +\n  theme_void()\n\npt\n```\n:::\n\n:::\n\n## Add Text\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n(p1 + pt) / p3\n```\n\n::: {.cell-output-display}\n![](07_layout_files/figure-revealjs/patchwork-composition-textbox-1.png){fig-align='center' width=4500}\n:::\n:::\n\n\n## Add Inset Plots\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\npl1 + inset_element(pl2, l = .6, b = .1, r = 1, t = .6)\n```\n\n::: {.cell-output-display}\n![](07_layout_files/figure-revealjs/patchwork-composition-inset-1-1.png){fig-align='center' width=3600}\n:::\n:::\n\n\n## Add Inset Plots\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\npl1 + inset_element(pl2, l = .6, b = 0, r = 1, t = .5, align_to = 'full')\n```\n\n::: {.cell-output-display}\n![](07_layout_files/figure-revealjs/patchwork-composition-inset-2-1.png){fig-align='center' width=3600}\n:::\n:::\n\n\n## Add Inset Plots\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n(pl1 + inset_element(pl2, l = .6, b = .1, r = 1, t = .6) + pt) / pl3\n```\n\n::: {.cell-output-display}\n![](07_layout_files/figure-revealjs/patchwork-composition-inset-3-1.png){fig-align='center' width=4500}\n:::\n:::\n\n\n## <b style='color:#663399;'>Recap</b>\n\n::: recap\n::: incremental\n-  **guides** are the combination of scales and legends\n-  legends can be either modified with the **`guide_*`** function in **`scale_*()`** or **`guides()`**  and with the **`theme()`** component\nqualitative\n-  ... while quantitative guides are **`colorbar`**, **`colorsteps`** or **`bins`**\n-  **`{patchwork}`** is the most modern and simplest way to compose plots\n    -  use `+`, `/` and `|` to combine plots\n    -  use `plot_layout()` to adjust the layout, widths and heights\n    -  use `plot_annotation()` to add tags and general labels\n    - use `inset_element()` to add inset graphics\n:::\n:::\n\n\n# Appendix\n\n## Legend with Color Shading\n\n\n::: {.cell output-location='column'}\n\n```{.r .cell-code  code-line-numbers=\"1,2,3|5,6,7,8,9,10,11,12,13,14,15,16,17|18,19,20,21,22,23,24|25,26,27,28,29|30,31,32,33,34|35,36,37,38\"}\nlibrary(colorspace)\nshades <- c(lighten(pal, .3),\n                  darken(pal, .3))\n\ng <-\n  bikes %>%\n  arrange(day_night, date) %>%\n  mutate(\n    season_day = paste(\n      str_to_title(season), day_night\n    ),\n    season_day = forcats::fct_inorder(season_day)\n  ) %>%\n  ggplot(\n    aes(x = season, y = count,\n        fill = season_day)\n  ) +\n  stat_summary(\n    geom = \"col\", fun = sum,\n    position = position_dodge2(\n      width = .2, padding = .1\n    )\n  ) +\n  scale_fill_manual(\n    values = shades, name = NULL\n  ) +\n  scale_x_discrete(\n    labels = str_to_title\n  ) +\n  scale_y_continuous(\n    labels = scales::comma_format(),\n    expand = c(0, 0),\n    limits = c(NA, 4500000)\n  ) +\n  theme(\n    panel.grid.major.x = element_blank(),\n    axis.title = element_blank()\n  )\n\ng\n```\n\n::: {.cell-output-display}\n![](07_layout_files/figure-revealjs/legend-shades-1.png){width=1500}\n:::\n:::\n\n\n## Legend on Top\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-line-numbers=\"2\"}\ng +\n  theme(legend.position = \"top\")\n```\n\n::: {.cell-output-display}\n![](07_layout_files/figure-revealjs/legend-shades-legend-top-1.png){fig-align='center' width=2700}\n:::\n:::\n\n\n## Resort Legend\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-line-numbers=\"2\"}\ng +\n  guides(fill = guide_legend(byrow = TRUE)) +\n  theme(legend.position = \"top\")\n```\n\n::: {.cell-output-display}\n![](07_layout_files/figure-revealjs/legend-shades-legend-byrow-1.png){fig-align='center' width=2700}\n:::\n:::\n",
    "supporting": [
      "07_layout_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    function fireSlideChanged(previousSlide, currentSlide) {\n\n      // dispatch for htmlwidgets\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for reveal\n    if (window.Reveal) {\n      window.Reveal.addEventListener(\"slidechanged\", function(event) {\n        fireSlideChanged(event.previousSlide, event.currentSlide);\n      });\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}